<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Simple Playlist Extractor â€” Embedded</title>
<style>
  :root { --bg:#ffffff; --text:#111827; --muted:#6b7280; --accent:#2563eb; --border:#e5e7eb; }
  html,body { margin:0; padding:0; background:var(--bg); color:var(--text); font-family: Arial, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, sans-serif; }
  .wrap { max-width: 980px; margin: 24px auto; padding: 12px; }
  h1 { font-size: 20px; margin: 0 0 8px 0; }
  .card { background:#fff; border:1px solid var(--border); border-radius: 12px; box-shadow: 0 1px 3px rgba(0,0,0,.05); }
  .card h2 { margin:0; padding:12px 14px; background:#f9fafb; border-bottom:1px solid var(--border); font-size:16px; }
  .content { padding:14px; }
  .row { display:flex; gap:12px; align-items:center; margin:8px 0; }
  input[type="file"] { border:1px solid var(--border); padding:8px; border-radius:8px; }
  textarea { width:100%; min-height:220px; border:1px solid var(--border); border-radius:10px; padding:10px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
  .btns { display:flex; gap:8px; flex-wrap:wrap; }
  button { border:1px solid var(--border); background:#fff; border-radius:10px; padding:8px 12px; cursor:pointer; }
  button.primary { background: var(--accent); color:white; border-color: var(--accent); }
  .muted { color: var(--muted); font-size: 12px; }
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <h2>Embedded Extractor</h2>
    <div class="content">
      <div class="row">
        <div class="muted">Drop a <b>.jwlplaylist</b> or <b>.jwlibrary</b> file here (or click to choose).</div>
      </div>
      <div class="row">
        <input id="file" type="file" accept=".jwlplaylist,.jwlibrary,.json,.txt">
        <div class="btns">
          <button class="primary" id="btnReset">Reset</button>
          <button id="btnCopy">Copy table</button>
        </div>
      </div>
      <div class="row"><textarea id="out" placeholder="Parsed output will appear here..."></textarea></div>
      <div class="muted">Tip: This embedded version is self-contained for GitHub Pages. No external dependencies required.</div>
    </div>
  </div>
</div>
<script>
(function(){
  const ta = document.getElementById('out');
  const fileInput = document.getElementById('file');
  const btnReset = document.getElementById('btnReset');
  const btnCopy = document.getElementById('btnCopy');

  function resetAll(){ ta.value=''; fileInput.value=''; }
  btnReset.addEventListener('click', resetAll);
  btnCopy.addEventListener('click', async () => { try{ await navigator.clipboard.writeText(ta.value||''); }catch(e){} });

  function parseText(txt){
    // minimal, safe parser stub (does NOT evaluate code)
    // show first 2000 chars and basic stats
    const head = txt.slice(0, 2000);
    const lines = txt.split(/\r?\n/).length;
    return `Lines: ${lines}\n\nPreview:\n${head}`;
  }

  async function readFile(f){
    const buf = await f.arrayBuffer();
    // We don't know the binary format; attempt to decode as UTF-8 for preview
    const dec = new TextDecoder('utf-8', {fatal:false}).decode(new Uint8Array(buf));
    ta.value = parseText(dec);
  }

  fileInput.addEventListener('change', () => {
    const f = fileInput.files && fileInput.files[0];
    if (f) readFile(f);
  });

  // Drag-and-drop
  document.addEventListener('dragover', e => e.preventDefault());
  document.addEventListener('drop', e => {
    e.preventDefault();
    const f = (e.dataTransfer && e.dataTransfer.files && e.dataTransfer.files[0]) || null;
    if (f) readFile(f);
  });
})();
</script>
</body>
</html>
